#!/usr/bin/env k

i:`I$".."\'", y="\15_*0:"inputs/17"

p:{(r;v):x;(r+v;v-1)}
dr:{(*x;0|*|x)}

f:{(x[0]<y+1)&x[1]>y-1}
cx@:&(|/f[i[0]]')'cx:*''{(dr@p@)\(0;x)}'!5+i[0;1]
cy@:&(|/f[i[1]]')'cy:*''{{i[1;0]<*x+1}p\(0;x)}'(2*i[1;0])+!4*-i[1;0]

cm:{nx:(*|x)^x@!#y;ny:y@!#nx;nx,'ny}
cxy@:&|/'&/''(+i f'+)'cxy:,/cx cm\:/:cy

|/|/'cxy[;;1]
#cxy
