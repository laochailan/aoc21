#!/usr/bin/env k

i:{x@<x}'''" "\''" | "\'0:"inputs/8"
nl:{x=#'y};ol:{+/'+/x=\:y};
l2:2 3 9 6!(5 2 4;5 2 1;6 4 4;6 1 1)
l3:0 5!(6 6 9; 5 2 3)
d1:{(1 4 7 8!x@(*&)'(2 4 3 7=\:#:'x))}
fn:{[it;x;y;z]nl[x;it]&y=ol[d1[it][z];it]}
d2:{(!l2)!fn[x].'.l2}
d3:{(!l3)!{[it;x;y;z] nl[x;it]&~d2[it][y]|d2[it][z]}[x].'.l3}
f:{{(.x)!!x}d1[x],x@(*&)'d2[x],d3[x]} 
dec:{(f x[0])@x[1]}'i
+//1 4 7 8=\:dec
+/(4#10)/'dec

